(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[330],{923:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[...slug]",function(){return r(2093)}])},2093:function(e,t,r){"use strict";r.r(t);var a=r(2676);r(5271);var s=r(2229),l=r.n(s),n=r(5550);t.default=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l(),{children:(0,a.jsx)("title",{children:"Databend"})}),(0,a.jsx)(n.Z,{})]})},5550:function(e,t,r){"use strict";var a=r(2676),s=r(5271),l=r(6058),n=r(9675),o=r(2327),i=r(987),d=r(9619),c=r(9822),u=r(5122);t.Z=()=>{let e=(0,l.useRouter)(),t=e.query.slug&&Array.isArray(e.query.slug)?e.query.slug.join("/"):e.query.slug,r=e.query.queryId,h=t||r,[g,m]=(0,s.useState)(""),[x,y]=(0,s.useState)([]),[p,f]=(0,s.useState)(!1),[b,N]=(0,s.useState)("");(0,s.useEffect)(()=>{e.isReady&&h&&"string"==typeof h?j(h):m("CREATE OR REPLACE TABLE students (uid Int16, name String, age Int16);\n\nINSERT INTO students VALUES (1231, 'John', 33);\nINSERT INTO students VALUES (6666, 'Ksenia', 48);\nINSERT INTO students VALUES (8888, 'Alice', 50);\n\nSELECT * FROM students;")},[e.isReady,h]);let j=async e=>{try{f(!0),N("");let t=await fetch("/api/query/".concat(e));if(t.ok){let e=await t.json();m(e.sql),y(e.results||[])}else N('Run ID "'.concat(e,'" not found')),y([])}catch(t){console.error("Failed to load shared query:",t),N('Failed to load run ID "'.concat(e,'"')),y([])}finally{f(!1)}},w=(0,s.useCallback)(async()=>{if(!g.trim()){alert("Please enter a SQL query");return}f(!0),N("");try{let t=await fetch("/api/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sql:g,kind:0})});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let r=await t.json();y(r.results||[]),r.queryId&&e.push("/".concat(r.queryId),void 0,{shallow:!0})}catch(e){console.error("Query execution failed:",e),alert("Query execution failed: "+e.message)}finally{f(!1)}},[g,e]);(0,s.useEffect)(()=>{let e=e=>{(e.metaKey||e.ctrlKey)&&"Enter"===e.key&&(e.preventDefault(),w())};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[w]);let v=(e,t)=>e.data&&Array.isArray(e.data)&&0!==e.data.length?(0,a.jsxs)("div",{className:"bg-white border border-gray-300 rounded-lg mb-4 overflow-hidden shadow-sm",children:[(0,a.jsxs)("div",{className:"bg-gray-50 border-b border-gray-300 px-4 py-3 font-medium text-gray-700",children:["Query ",t+1," (",e.rowCount," rows, ",e.duration,")"]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full border-collapse",children:[(0,a.jsx)("thead",{children:(0,a.jsx)("tr",{className:"bg-gray-100",children:e.columns.map((t,r)=>(0,a.jsxs)("th",{className:"border border-gray-300 px-4 py-3 text-left font-semibold text-gray-900 bg-gray-50",children:[t,e.types&&e.types[r]&&(0,a.jsx)("div",{className:"text-xs font-normal text-left text-gray-500 mt-1",children:e.types[r]})]},r))})}),(0,a.jsx)("tbody",{children:e.data.map((e,t)=>(0,a.jsx)("tr",{className:t%2==0?"bg-white":"bg-gray-50",children:e.map((e,t)=>(0,a.jsx)("td",{className:"border border-gray-300 px-4 py-2 text-gray-900 font-mono text-sm",children:e||""},t))},t))})]})})]},t):(0,a.jsxs)("div",{className:"bg-white border border-gray-300 rounded-lg mb-4 overflow-hidden shadow-sm",children:[(0,a.jsxs)("div",{className:"bg-gray-50 border-b border-gray-300 px-4 py-3 font-medium text-gray-700",children:["Query ",t+1," (",e.rowCount," rows, ",e.duration,")"]}),(0,a.jsx)("div",{className:"p-4 text-center text-gray-500",children:"No data returned"})]},t);return(0,a.jsxs)("div",{className:"h-full bg-gray-100",children:[(0,a.jsx)("div",{className:"bg-yellow-400 px-4 py-2 flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("span",{className:"font-bold",children:"SQL Query"}),(0,a.jsx)("button",{onClick:w,disabled:p,className:"bg-indigo-600 hover:bg-indigo-700 disabled:opacity-60 disabled:cursor-not-allowed text-white px-4 py-1.5 rounded-md flex items-center gap-2 text-sm",children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"RUNNING..."]}):(0,a.jsx)(a.Fragment,{children:"â–¶ RUN QUERY"})})]})}),(0,a.jsx)("div",{className:"h-[calc(100vh-48px)] border border-gray-300",children:(0,a.jsxs)(c.eh,{direction:"horizontal",className:"h-full",children:[(0,a.jsx)(c.s_,{defaultSize:50,minSize:20,className:"h-full",children:(0,a.jsx)("div",{className:"h-full border-r border-gray-300 relative",children:(0,a.jsx)(n.ZP,{value:g,placeholder:"Enter your SQL queries here... (Press Cmd+Enter to run)",theme:u.tR,height:"100%",extensions:[u.MH,i.tk.lineWrapping,(0,d.ys)({icons:!1}),(0,o.i6)()],basicSetup:{lineNumbers:!0,foldGutter:!1,indentOnInput:!1,autocompletion:!0,highlightActiveLine:!1},onChange:e=>m(e),editable:!p,style:{height:"100%",fontSize:"14px"}})})}),(0,a.jsx)(c.OT,{className:"w-1 bg-gray-300 hover:bg-gray-400 cursor-col-resize"}),(0,a.jsx)(c.s_,{defaultSize:50,minSize:20,className:"h-full",children:(0,a.jsx)("div",{className:"h-full overflow-auto bg-white relative",children:(0,a.jsx)("div",{className:"p-2 h-full",children:b?(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-300 rounded-lg p-4 text-red-700",children:[(0,a.jsx)("div",{className:"font-medium text-red-800 mb-1",children:"Error"}),(0,a.jsx)("div",{className:"text-sm",children:b})]})}):x.length>0?(0,a.jsx)("div",{className:"space-y-4",children:x.map((e,t)=>v(e,t))}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500",children:"Execute a query to see results"})})})})]})})]})}},5122:function(e,t,r){"use strict";r.d(t,{MH:function(){return i},tR:function(){return o}});var a=r(1861),s=r(3233),l=r(987);let n={background:"#fff",foreground:"#3D3D3D",selection:"#BBDFFF",selectionMatch:"#BBDFFF",gutterBackground:"#fff",gutterForeground:"#AFAFAF",lineHighlight:"#EDF4FF"},o=function(e){let{theme:t="light",settings:r={},styles:l=[]}={};return(0,s.j)({theme:t,settings:{...n,...r},styles:[{tag:[a.pJ.comment,a.pJ.quote],color:"#707F8D"},{tag:[a.pJ.typeName,a.pJ.typeOperator],color:"#aa0d91"},{tag:[a.pJ.keyword],color:"#aa0d91",fontWeight:"bold"},{tag:[a.pJ.string,a.pJ.meta],color:"#D23423"},{tag:[a.pJ.name],color:"#032f62"},{tag:[a.pJ.typeName],color:"#522BB2"},{tag:[a.pJ.variableName],color:"#23575C"},{tag:[a.pJ.definition(a.pJ.variableName)],color:"#327A9E"},{tag:[a.pJ.regexp,a.pJ.link],color:"#0e0eff"},...l]})}(),i=l.tk.theme({"&":{fontSize:"12pt",border:"1px solid #556cd6","border-radius":"3px",padding:"3px"},"&.cm-editor.cm-focused":{outline:"none","border-width":"2px","border-color":"#fcd004"},".cm-tooltip-autocomplete":{border:"1px solid #556cd6","border-radius":"3px",margin:"3px",padding:"3px",background:"white",color:"black"},".cm-completionMatchedText":{"text-decoration":"none"},".cm-tooltip-autocomplete ul li[aria-selected]":{background:"white",color:"black","font-weight":"bold"}})}},function(e){e.O(0,[430,736,888,774,179],function(){return e(e.s=923)}),_N_E=e.O()}]);