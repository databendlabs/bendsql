(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{6442:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return r(9155)}])},9155:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var n=r(2676),s=r(5271),l=r(6058),a=r(7292),i=r.n(a),o=r(2081),d=()=>{let{dsns:e,currentDsn:t,selectDsn:r,addDsn:l,removeDsn:a}=(0,o.X)(),[i,d]=(0,s.useState)(!1),[c,u]=(0,s.useState)(""),[x,m]=(0,s.useState)(""),[f,h]=(0,s.useState)(null),p=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(!i)return;let e=e=>{p.current&&!p.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[i]),(0,s.useEffect)(()=>{f&&h(null)},[x,c,f]);let g=(e,t)=>{e.stopPropagation(),a(t)};return(0,n.jsxs)("div",{className:"relative",ref:p,children:[(0,n.jsxs)("button",{type:"button",onClick:()=>d(e=>!e),className:"flex items-center gap-2 rounded-full border border-black/10 bg-white/80 px-4 py-1.5 text-left shadow-sm hover:shadow transition text-sm",title:"Select DSN",children:[(0,n.jsx)("div",{className:"flex flex-col",children:(0,n.jsx)("span",{className:"text-gray-900 font-semibold",children:t.name})}),(0,n.jsx)("svg",{className:"h-3 w-3 text-gray-500 transition-transform ".concat(i?"rotate-180":""),viewBox:"0 0 12 8",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:(0,n.jsx)("path",{d:"M11 1.5 6 6.5 1 1.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})]}),i&&(0,n.jsxs)("div",{className:"absolute right-0 z-20 mt-2 w-80 rounded-2xl border border-gray-200 bg-white shadow-xl",children:[(0,n.jsxs)("div",{className:"border-b border-gray-100 px-4 py-3",children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Connections"}),(0,n.jsx)("p",{className:"text-xs text-gray-400",children:"Stored locally in this browser"})]}),(0,n.jsx)("div",{className:"max-h-72 overflow-y-auto px-3 py-3 space-y-2",children:e.map(e=>{var s;return(0,n.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-white",children:[(0,n.jsx)("button",{type:"button",onClick:()=>{r(e.id),d(!1)},className:"w-full rounded-xl px-3 py-3 text-left transition ".concat(t.id===e.id?"border border-indigo-200 bg-indigo-50":"hover:border hover:border-gray-200 hover:bg-gray-50"),children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:e.name}),(0,n.jsx)("p",{className:"text-xs text-gray-500 break-all",children:null!==(s=e.dsn)&&void 0!==s?s:"Use BendSQL web DSN"})]}),t.id===e.id&&(0,n.jsx)("span",{className:"rounded-full bg-indigo-100 px-2 py-0.5 text-[10px] font-semibold uppercase text-indigo-600",children:"Active"})]})}),!e.isDefault&&(0,n.jsx)("div",{className:"flex justify-end px-2 pb-2",children:(0,n.jsx)("button",{type:"button",onClick:t=>g(t,e.id),className:"text-xs font-medium text-red-500 hover:text-red-600",children:"Remove"})})]},e.id)})}),(0,n.jsx)("div",{className:"border-t border-gray-100 px-4 py-3",children:(0,n.jsxs)("form",{className:"space-y-2",onSubmit:t=>{t.preventDefault();let r=x.trim();if(!r){h("Please enter a DSN value");return}l(c.trim()||"Connection ".concat(e.length),r)&&(u(""),m(""),h(null),d(!1))},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs font-semibold text-gray-500",children:"Name"}),(0,n.jsx)("input",{type:"text",value:c,onChange:e=>u(e.target.value),placeholder:"My connection",className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 text-sm text-gray-700 focus:border-indigo-400 focus:outline-none"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs font-semibold text-gray-500",children:"DSN"}),(0,n.jsx)("input",{type:"text",value:x,onChange:e=>m(e.target.value),placeholder:"databend://user:pass@host:port/default",className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 text-sm text-gray-700 focus:border-indigo-400 focus:outline-none",required:!0})]}),f&&(0,n.jsx)("p",{className:"text-xs text-red-500",children:f}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-[11px] uppercase tracking-wide text-gray-400",children:"DSN is only stored locally"}),(0,n.jsx)("button",{type:"submit",className:"rounded-full bg-indigo-600 px-4 py-1.5 text-xs font-semibold uppercase tracking-wide text-white shadow-sm hover:bg-indigo-500 disabled:opacity-50",disabled:!x.trim(),children:"Add DSN"})]})]})})]})]})},c=e=>{let{children:t}=e,r=(0,l.useRouter)(),s=e=>{let t=r.asPath.split("?")[0]||"/";return"/"===e?"/"===t:t.startsWith(e)};return(0,n.jsxs)("div",{className:"flex h-screen min-h-screen flex-col bg-[#ffe895]",children:[(0,n.jsx)("header",{className:"border-b border-yellow-300 bg-yellow-400",children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-between gap-4 px-6 py-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)("span",{className:"text-lg font-bold text-gray-900",children:"BendSQL"}),(0,n.jsx)("nav",{className:"flex items-center gap-2",children:[{name:"Query",path:"/",icon:"\uD83D\uDCCA"},{name:"Notebooks",path:"/notebooks",icon:"\uD83D\uDCD3"},{name:"Perf",path:"/perf/0",icon:"âš¡"}].map(e=>(0,n.jsxs)(i(),{href:e.path,className:"inline-flex items-center gap-2 rounded-full px-4 py-1.5 text-sm font-semibold transition ".concat(s(e.path)?"bg-white text-gray-900 shadow":"text-gray-900/70 hover:text-gray-900"),children:[(0,n.jsx)("span",{children:e.icon}),(0,n.jsx)("span",{children:e.name})]},e.path))})]}),(0,n.jsx)("div",{className:"flex items-center gap-3",children:(0,n.jsx)(d,{})})]})}),(0,n.jsx)("main",{className:"flex-1 overflow-hidden bg-[#f9fbff] flex flex-col min-h-0 h-full",children:(0,n.jsx)("div",{className:"flex-1 min-h-0 flex flex-col h-full",children:t})})]})};r(6710),r(2260);var u=function(e){let{Component:t,pageProps:r}=e;return(0,n.jsx)(o.g,{children:(0,n.jsx)(c,{children:(0,n.jsx)(t,{...r})})})}},2081:function(e,t,r){"use strict";r.d(t,{X:function(){return m},g:function(){return x}});var n=r(2676),s=r(5271);let l="bendsql-dsns",a="default",i=Object.freeze({id:a,name:"Default",dsn:null,isDefault:!0}),o=(0,s.createContext)(void 0),d=()=>"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():"dsn-".concat(Date.now().toString(36),"-").concat(Math.random().toString(36).slice(2,8)),c=e=>[i,...e.filter(e=>e.id!==a)],u=e=>{if(!Array.isArray(e))return[];let t=[];return e.forEach(e=>{if(!e||"object"!=typeof e||e.id===a)return;let r="string"==typeof e.id&&e.id.trim().length>0?e.id:d(),n="string"==typeof e.name&&e.name.trim().length>0?e.name.trim():"Custom DSN",s="string"==typeof e.dsn&&e.dsn.trim().length>0?e.dsn.trim():null;s&&t.push({id:r,name:n,dsn:s})}),t},x=e=>{let{children:t}=e,[r,x]=(0,s.useState)([i]),[m,f]=(0,s.useState)(a),[h,p]=(0,s.useState)(!1);(0,s.useEffect)(()=>{try{let e=window.localStorage.getItem(l);if(e){let t=JSON.parse(e),r=u(null==t?void 0:t.custom),n=c(r);x(n);let s="string"==typeof(null==t?void 0:t.currentId)?t.currentId:a,l=n.some(e=>e.id===s)?s:a;f(l)}else x([i]),f(a)}catch(e){console.error("Failed to load DSNs from storage:",e),x([i]),f(a)}finally{p(!0)}},[]),(0,s.useEffect)(()=>{if(h)try{let e={custom:r.filter(e=>e.id!==a),currentId:m};window.localStorage.setItem(l,JSON.stringify(e))}catch(e){console.error("Failed to save DSNs to storage:",e)}},[r,m,h]);let g=(0,s.useCallback)(e=>{f(t=>e===t?t:r.some(t=>t.id===e)?e:a)},[r]),b=(0,s.useCallback)((e,t)=>{let r=t.trim();if(!r)return null;let n={id:d(),name:e.trim()||"Custom DSN",dsn:r};return x(e=>c([...e,n])),f(n.id),n},[]),y=(0,s.useCallback)((e,t)=>{if(e===a)return x(e=>c(e)),i;let r=null;return x(n=>c(n.map(n=>{if(n.id!==e)return n;let s="string"==typeof t.name&&t.name.trim().length>0?t.name.trim():n.name,l="string"==typeof t.dsn&&t.dsn.trim().length>0?t.dsn.trim():n.dsn;if(!l)return n;let a={...n,name:s,dsn:l};return r=a,a}))),r},[]),N=(0,s.useCallback)(e=>{e!==a&&(x(t=>c(t.filter(t=>t.id!==e))),f(t=>t===e?a:t))},[]),j=(0,s.useMemo)(()=>{let e=r.find(e=>e.id===m);return null!=e?e:i},[r,m]),v=(0,s.useMemo)(()=>({dsns:r,currentDsn:j,currentDsnId:m,selectDsn:g,addDsn:b,updateDsn:y,removeDsn:N}),[r,j,m,g,b,y,N]);return(0,n.jsx)(o.Provider,{value:v,children:t})},m=()=>{let e=(0,s.useContext)(o);if(!e)throw Error("useDsn must be used within a DsnProvider");return e}},2260:function(){},6710:function(){}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[736,774,179],function(){return t(6442),t(3841)}),_N_E=e.O()}]);